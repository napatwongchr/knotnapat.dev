---
title: เมื่อไหร่ที่เราควรจะแยก React Component ?
date: "2015-05-01T22:12:03.284Z"
description: แยก Component ยังไงดีให้มันดูแลรักษาง่าย
---

![Broken Bear](./broken-bear.jpg)

<p align="center">
  ขอบคุณรูปจาก <a href="https://unsplash.com/@trymon">Trym Nilsen</a>
</p>

ช่วงนี้ผมได้ทำ Code Review มากขึ้น และได้อ่านโค้ดจากเพื่อนในทีมหลาย ๆ คน

ซึ่งสิ่งที่มีการพูดคุยกันมากในทีม และยังมีความไม่ชัดเจน ซึ่งก็คือเรื่องของ

###"เมื่อไหร่ที่เราควรจะแยก Component"

ซึ่งประเด็นนี้ผมนั่งคิดทบทวน ทำการหาข้อมูล และพยายามตกผลึกให้มันชัดเจนมากที่สุด อยู่หลายวัน ซึ่งผมจะสรุปสิ่งที่ผมนั่งตกผลึกมาในโพสต์นี้

จริง ๆ แล้วเวลาเราเขียน React App เราสามารถที่จะเขียนอยู่ในไฟล์เดียวกันก็ได้ครับ มันไม่ได้ว่าทำไม่ได้ แต่จะเกิดอะไรขึ้นบ้างหล่ะ ถ้าเราเขียนทุกอย่างไว้ในไฟล์เดียว ซึ่งปัญหาที่จะเกิดขึ้นมีดังนี้

##1. เราจะโฟกัสการทำงานของตัวระบบในส่วนต่าง ๆ ของโค้ดได้ยาก

ข้อนี้เพื่อน ๆ คงนึกออกดีเลยถ้าเรายัดของไว้ในไฟล์เดียวทั้งหมด แน่นอนครับ มันดูแลรักษายากมาก เราจึงจำเป็นต้องแยกโค้ดบางส่วนออกไป

**แต่ ! แต่ ! แต่ ! ผมอยากจะเน้นตรงส่วนนี้ให้มาก**

การแยกโค้ดบางส่วนออกไปนัั้นเราต้องนึกเรื่องของการทำงานที่สัมพันธ์กันของตัวโค้ดด้วย ถ้าโค้ดที่มันทำงานสัมพันธ์กัน เราไม่ควรแยกมันออกไปไกลจากกัน มันจะทำให้เราดูแลรักษาได้ยากขึ้น

ลองนึกภาพถ้าเรายังแยกโค้ดออกไป เพื่อให้มันดูเป็นระเบียบ แต่เวลาเรากับมาอ่านอีกรอบ เรายังรู้สึกว่า เรายังใช้สมองเยอะในการไล่หาโค้ดส่วนต่าง ๆ อยู่ แสดงว่าเรายังแยกโค้ดไม่ดีพอ

####หัวใจสำคัญ ข้อที่ 1

การแยกโค้ดก้อนใหญ่ ๆ ออกไปเพื่อให้มันจัดการง่ายนั้น มันต้องทำให้เรารู้สึกว่า มันสามารถลดการคิดของสมองเราได้มากขึ้น ไม่ใช่แยกเพราะคิดว่าต้องแยกเพื่อความดูเป็นระเบียบ ความสบายใจของตัวเราเอง ว่าเอ้อ แยกเป็นระเบียบละ

การแยกโค้ดออกมามันจะเป็นการสร้าง Abstraction เพิ่มขึ้นมาในตัวโค้ดของเรา Abstraction เป็นสิ่งที่ดี แต่ถ้าเราสร้าง Abstraction เร็วเกินไปมันจะทำให้ตัวโค้ดของเราซับซ้อนมากขึ้น ถ้าเวลาผ่านไปมันจะสร้าง Cost ในการดูแลรักษาตัวโค้ดของระบบเรามากขึ้น

["Prefer duplication over wrong abstraction"](https://www.sandimetz.com/blog/2016/1/20/the-wrong-abstraction) -- Sandi Metz

####หัวใจสำคัญ ข้อที่ 2

เราไม่ควรสร้าง Abstraction เร็วเกินไป เพื่อให้ชัดเจนกว่านั้นคือ เราไม่ควรแยก Component ออกมาเร็วเกินไป ให้ลองนั่ง ๆ เขียนไปก่อน ให้มีโมเม้นแบบ อ๋อ ! เอ้อ ! มันคือ Abstraction นี้แหล่ะ แนะนำให้อ่านคอนเซ็ปของ ["AHA Programming"](https://kentcdodds.com/blog/aha-programming/)

##2. ทำให้จัดการ State และ Event handlers ใน App ของเรายากมากกว่าเดิมเยอะมาก

ลองนึกภาพถ้าเรามี Component ต่างๆ รวมไว้ในไฟล์เดียวกัน ซึ่ง Component ในไฟล์นี้ต่างมี State และ Event handlers ที่ใช้ต่างกันออกไปเยอะมาก ๆ ลองนึกภาพตามครับ มันจัดการยากแน่นอน แต่ถ้าเราแยกออกมา (อย่าลืมคิดถึงข้อ 1 ด้วยนะ) มันจะทำให้เรารู้ว่า State ไหนใช้กับ Component อะไร และจะจัดการ Events ได้ง่ายมากขึ้น

##3. เรื่องของ Performance

ถ้าเรามี Component ก้อนโต นึกภาพเวลา State เปลี่ยนมันจะ Rerender ทั้ง App เราซึ่งมีผลกับ Performance แน่นอน

####หัวใจสำคัญ ข้อที่ 3

ถ้าเราแยก Component ออกไป แล้วเอา State ที่จะใช้แค่ Component นั้น ๆ ไปไว้ใกล้มันมากที่สุดมันจะช่วยเรื่อง Performance ได้โดยการลดการ Rerender ของ Component อื่น ๆ ได้ด้วยนะ

##4. เรื่องของการ Reuse โค้ด

แน่นอนครับ การรวมโค้ดไว้ไฟล์เดียวใหญ่ ๆ มันทำให้เรา Reuse โค้ดได้ยากมากขึ้น

##5. เวลาเราทำงานในทีมหลาย ๆ คน จะมี Conflict เวลา Merge Code เข้ากันแน่นอน

####หัวใจสำคัญก่อนจาก

Component ที่ยาว ๆ ไม่ได้แปลก อย่ากลัวการเขียนโค้ดที่ยาว การที่เรารวม Component ไว้เป็นก้อนเดียวกัน มันลดปัญหา Prop Drilling ได้ด้วยนะ โค้ดที่ทำงานสัมพันธ์กัน ถูกแยกออกจากกันน่ากลัวกว่าเยอะเลยครับ

ขอบคุณครับ

###Reference
[When to break up a component into multiple components](https://kentcdodds.com/blog/when-to-break-up-a-component-into-multiple-components)
